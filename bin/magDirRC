#!/bin/bash

function ask() {
	ls
	pwd
	echo ""
	echo "This Script will replace all spaces with underscores in file or folder names,"
	echo " recursively in the present working directory and in all sub-directories."
	echo ""
	echo "A reduced quality .jpg will be placed beside the .png it was created from!"
	echo ""
	echo "It Depends on 'imagemagick' and 'rename':"
	echo "sudo apt-get update && apt-get upgrade"
	echo "sudo apt-get install imagemagick"
	echo "sudo apt install rename"
	echo ""
	echo "Would you like to run magDirRC now?"
	echo "( y = Yes | n = No )"
	read reply

	if [ "$reply" == 'y' ]; then
		# Renames all .png files & no folders
		#find $1 -name "* *.png" -type f -print0 | \
		#while read -d $'\0' f; do mv -v "$f" "${f// /_}"; done

		# Depends on "sudo apt install rename"
		# Replaces all spaces in file or folder names recursively in the present working directory and all sub-directories
		find -depth -name "* *" -execdir rename 's/ /_/g' "{}" \;

		# Depends on "sudo apt-get install imagemagick"
		# In most cases reduces .png file size in the present working directory and all sub-directories
		for photos in $(find . -name "*.png");do convert -verbose "$photos" -quality 75% "$photos-imagic75.jpg"; done
	fi

	if [ "$reply" == 'n' ]; then
	    echo "No, Canceling Job"
	fi

	if [[ ( "$reply" != 'y' ) && ( "$reply" != 'n' ) ]]; then
        echo "#######################"
		echo "### Invalid Answer  ###"
        echo "#######################"
		ask
	fi
}

ask

